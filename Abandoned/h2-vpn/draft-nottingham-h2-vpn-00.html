<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN" "about:legacy-compat">
<html lang="en"><head profile="http://dublincore.org/documents/2008/08/04/dc-html/"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Virtual Private Networking over HTTP/2</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"><style type="text/css">
      body {
        padding-top: 80px;
        padding-bottom: 80px;
        position: relative;
      }
      .table.header th, .table.header td {
        border-top: none;
        padding: 0;
      }
      #rfc\.meta {
        width: 40%;
        float: right
      }
      #rfc\.toc > ul li {
        list-style: none;
      }
      .container .nav-sublist {
        padding-left: 20px;
        padding-right: 10px;
        font-size: 90%;
      }
      .container .navbar-brand {
        padding-top: 0;
      }
      .container .nav > li > a {
        padding: 10px 7px 5px 15px;
        display: inline-block;
      }
      .container .nav > li > a + a {
        padding: 10px 15px 5px 7px;
        display: inline-block;
      }
      .container .nav > li > a {
        padding: 5px 10px;
      }
      .filename {
        color: rgb(119, 119, 119);
        font-size: 23px;
        font-weight: normal;
        height: auto;
        line-height: 23px;
      }
      dl {
        margin-left: 1em;
      }
      dl.dl-horizontal: {
        margin-left: 0;
      }
      dl > dt {
        float: left;
        margin-right: 1em;
      }
      dl.nohang > dt {
        float: none;
      }
      dl > dd {
        margin-bottom: .5em;
      }
      dl.compact > dd {
        margin-bottom: 0em;
      }
      dl > dd > dl {
        margin-top: 0.5em;
        margin-bottom: 0em;
      }
      td.reference {
        padding-right: 1em;
        vertical-align: top;
      }
      .feedback {
        position: fixed;
        bottom: 5px;
        right: 5px;
      }
      .fbbutton {
        margin-left: 5px;
      }
      h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
        color: rgb(51, 51, 51);
      }
    </style><link rel="Author" href="#rfc.authors"><link rel="Copyright" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 Extensions for VPN over HTTP/2" href="#rfc.section.2"><link rel="Chapter" title="3 VPN over HTTP/2 Operation" href="#rfc.section.3"><link rel="Chapter" title="4 IANA Considerations" href="#rfc.section.4"><link rel="Chapter" title="5 Security Considerations" href="#rfc.section.5"><link rel="Chapter" href="#rfc.section.6" title="6 Normative References"><link rel="Appendix" title="A TODO" href="#rfc.section.A"><meta name="generator" content="https://github.com/mnot/RFCBootstrap XSLT vendor: SAXON 9.1.0.8 from Saxonica http://www.saxonica.com/"><meta name="keywords" content="Internet-Draft"><link rel="schema.dct" href="http://purl.org/dc/terms/"><meta name="dct.creator" content="Nottingham, M."><meta name="dct.identifier" content="urn:ietf:id:draft-nottingham-h2-vpn-00"><meta name="dct.issued" scheme="ISO8601" content="2015-09-24"><meta name="dct.abstract" content="This document describes a set of extensions that allow an IP-based Virtual Private Network to be created over a HTTP/2 connection."><meta name="description" content="This document describes a set of extensions that allow an IP-based Virtual Private Network to be created over a HTTP/2 connection."></head><body><div class="container" id="top"><div class="row"><div class="col-md-4 col-md-push-8 hidden-sm hidden-xs" role="navigation"><div class="navbar"><div class="navbar-brand"><a href="#top">Internet-Draft</a></div><br clear="all"><div class=""><div id="rfc.toc"><ul class="nav"><li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">Introduction</a><ul><li><a href="#rfc.section.1.1">1.1</a>&nbsp;&nbsp;&nbsp;<a href="#notational-conventions">Notational Conventions</a></li></ul></li><li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#extensions-for-vpn-over-http2">Extensions for VPN over HTTP/2</a><ul><li><a href="#rfc.section.2.1">2.1</a>&nbsp;&nbsp;&nbsp;<a href="#the-startvpn-http2-frame-type">The STARTVPN HTTP/2 Frame Type</a></li><li><a href="#rfc.section.2.2">2.2</a>&nbsp;&nbsp;&nbsp;<a href="#the-ip-http2-frame-type">The IP HTTP/2 Frame Type</a></li></ul></li><li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#vpn-over-http2-operation">VPN over HTTP/2 Operation</a></li><li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#iana-considerations">IANA Considerations</a></li><li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#security-considerations">Security Considerations</a></li><li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">Normative References</a></li><li><a href="#rfc.section.A">A.</a>&nbsp;&nbsp;&nbsp;<a href="#todo">TODO</a></li><li><a href="#rfc.authors">Author's Address</a></li></ul></div></div></div></div><div class="col-md-8 col-md-pull-4 main" role="main"><table class="table table-condensed header" id="rfc.headerblock"><tbody><tr><td class="text-left">Network Working Group</td><td class="text-right">M. Nottingham</td></tr><tr><td class="text-left">Internet-Draft</td><td class="text-right">September 24, 2015</td></tr><tr><td class="text-left">Intended status: Informational</td><td class="text-right"></td></tr><tr><td class="text-left">Expires: March 27, 2016</td><td class="text-right"></td></tr></tbody></table><div id="rfc.title"><h1>Virtual Private Networking over HTTP/2</h1><p class="filename">draft-nottingham-h2-vpn-00</p></div><hr><h2 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h2><div class="lead"><p>This document describes a set of extensions that allow an IP-based Virtual Private Network to be created over a HTTP/2 connection.</p></div><h2 id="rfc.note.1"><a href="#rfc.note.1">Note to Readers</a></h2><p>The issues list for this draft can be found at <a href="https://github.com/mnot/I-D/labels/h2-vpn">https://github.com/mnot/I-D/labels/h2-vpn</a>.</p><div id="rfc.status"><h2><a href="#rfc.status">Status of this Memo</a></h2><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p><p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF). Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.</p><p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time. It is inappropriate to use Internet-Drafts as reference material or to cite them other than as “work in progress”.</p><p>This Internet-Draft will expire on March 27, 2016.</p></div><div id="rfc.copyrightnotice"><h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2><p>Copyright © 2015 IETF Trust and the persons identified as the document authors. All rights reserved.</p><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p></div><div id="introduction"><h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a href="#introduction">Introduction</a></h2><div id="rfc.section.1.p.1"><p>Virtual Private Networks have become a common means of assuring that traffic is carried over a protected network. However, current VPN technologies can often be easily discriminated from non-VPN traffic, leading to them being blocked in some networks.</p></div><div id="rfc.section.1.p.2"><p>As HTTP/2 is deployed more, it becomes an attractive substrate for carrying a VPN, due to its lack of discriminators, its multiplexed, low-overhead framing layer, its typical use of encryption, and the large number of HTTP endpoints on the Internet.</p></div><div id="rfc.section.1.p.3"><p>This document describes a set of extensions that allow an IP-based Virtual Private Network to be created over a HTTP/2 connection.</p></div><div id="notational-conventions"><h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1</a>&nbsp;<a href="#notational-conventions">Notational Conventions</a></h3><div id="rfc.section.1.1.p.1"><p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in <a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>.</p></div></div></div><div id="extensions-for-vpn-over-http2"><h2 id="rfc.section.2"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#extensions-for-vpn-over-http2">Extensions for VPN over HTTP/2</a></h2><div id="the-startvpn-http2-frame-type"><h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1</a>&nbsp;<a href="#the-startvpn-http2-frame-type">The STARTVPN HTTP/2 Frame Type</a></h3><div id="rfc.section.2.1.p.1"><p>The STARTVPN frame (type=0xf0) is used to open a stream (<a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a> Section 5.1) that represents a Virtual Private Network.</p></div><div id="rfc.section.2.1.p.2"><p>A STARTVPN frame can be sent on a stream in the “idle” state to request creation of a VPN with the peer; it transitions the stream to the “open” state. Once a stream is opened in this fashion, the recipient can send a single STARTVPN frame to acknowledge the opening, or a RST_STREAM frame to close the stream.</p></div><div id="rfc.section.2.1.p.3"><p>STARTVPN frames MAY also contain padding. Padding can be added to STARTVPN frames to obscure the size of messages. Padding is a security feature; see <a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a>, Section 10.7.</p></div><div id="rfc.figure.u.1"><pre>
 +---------------+---------------+
 |   Magic (8)   |Pad Length? (8)|
 +---------------+-----------------------------------------------+
 |                          Auth Data (*)                      ...
 +---------------------------------------------------------------+
 |                           Padding (*)                       ...
 +---------------------------------------------------------------+
</pre></div><div id="rfc.section.2.1.p.4" class="avoidbreakafter"><p>The STARTVPN frame payload has the following fields:</p></div><div id="rfc.section.2.1.p.5"><ul><li>Magic: Because this protocol uses HTTP/2 Experimental Use frame types, a prefix is used to disambiguate its use. This value is fixed as the ASCII string “nocensor” (0x6e 0x6f 0x63 0x65 0x6e 0x73 0x6f 0x72).</li><li>Auth Data: Authentication data. This field can carry arbitrary authentication data, typically pre-arranged with the server.</li><li>Pad Length: An 8-bit field containing the length of the frame padding in units of octets. This field is only present if the PADDED flag is set.</li><li>Padding: Padding octets that contain no application semantic value. Padding octets MUST be set to zero when sending. A receiver is not obligated to verify padding but MAY treat non-zero padding as a connection error (<a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a>, Section 5.4.1) of type PROTOCOL_ERROR.</li></ul></div><div id="rfc.section.2.1.p.6" class="avoidbreakafter"><p>The STARTVPN frame defines the following flags:</p></div><div id="rfc.section.2.1.p.7"><ul><li>PADDED (0x0): When set, bit 0 indicates that the Pad Length field and any padding that it describes are present.</li></ul></div><div id="rfc.section.2.1.p.8"><p>The total number of padding octets is determined by the value of the Pad Length field. If the length of the padding is the length of the frame payload or greater, the recipient MUST treat this as a connection error (<a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a> Section 5.4.1) of type PROTOCOL_ERROR.</p></div><div id="rfc.section.2.1.p.9"><p>STARTVPN frames MUST be associated with a stream. If a STARTVPN frame is received whose stream identifier field is 0x0, the recipient MUST respond with a connection error (<a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a>, Section 5.4.1) of type PROTOCOL_ERROR.</p></div></div><div id="the-ip-http2-frame-type"><h3 id="rfc.section.2.2"><a href="#rfc.section.2.2">2.2</a>&nbsp;<a href="#the-ip-http2-frame-type">The IP HTTP/2 Frame Type</a></h3><div id="rfc.section.2.2.p.1"><p>IP frames (type=0xf1) convey individual IP packets in the Virtual Private Network associated with the stream ID.</p></div><div id="rfc.section.2.2.p.2"><p>IP frames MAY also contain padding. Padding can be added to IP frames to obscure the size of messages. Padding is a security feature; see <a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a>, Section 10.7.</p></div><div id="rfc.figure.u.2"><pre>
 +---------------+
 |Pad Length? (8)|
 +---------------+-----------------------------------------------+
 |                           IP Data (*)                       ...
 +---------------------------------------------------------------+
 |                           Padding (*)                       ...
 +---------------------------------------------------------------+
</pre></div><div id="rfc.section.2.2.p.3" class="avoidbreakafter"><p>The IP frame contains the following fields:</p></div><div id="rfc.section.2.2.p.4"><ul><li>Pad Length: An 8-bit field containing the length of the frame padding in units of octets. This field is conditional (as signified by a “?” in the diagram) and is only present if the PADDED flag is set.</li><li>IP Data: Transport data. The amount of data is the remainder of the frame payload after subtracting the length of the other fields that are present.</li><li>Padding: Padding octets that contain no application semantic value. Padding octets MUST be set to zero when sending. A receiver is not obligated to verify padding but MAY treat non-zero padding as a connection error (<a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a>, Section 5.4.1) of type PROTOCOL_ERROR.</li></ul></div><div id="rfc.section.2.2.p.5" class="avoidbreakafter"><p>The IP frame defines the following flags:</p></div><div id="rfc.section.2.2.p.6"><ul><li>END_STREAM (0x1): When set, bit 0 indicates that this frame is the last that the endpoint will send for the identified stream. Setting this flag causes the stream to enter one of the “half-closed” states or the “closed” state (<a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a>, Section 5.1).</li><li>V6 (0x2): When set, bit 1 indicates that this frame is an IPv6 <a href="#RFC2460"><cite title="Internet Protocol, Version 6 (IPv6) Specification">[RFC2460]</cite></a> frame; otherwise, it is an IPv4 <a href="#RFC0791"><cite title="Internet Protocol">[RFC0791]</cite></a> frame.</li><li>PADDED (0x4): When set, bit 3 indicates that the Pad Length field and any padding that it describes are present.</li></ul></div><div id="rfc.section.2.2.p.7"><p>IP frames MUST be associated with a stream. If an IP frame is received whose stream identifier field is 0x0, the recipient MUST respond with a connection error (<a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a>, Section 5.4.1) of type PROTOCOL_ERROR.</p></div><div id="rfc.section.2.2.p.8"><p>IP frames are subject to flow control (<a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a>, Section 5.2) and can only be sent when a stream is in the “open” or “half-closed (remote)” state. The entire IP frame payload is included in flow control, including the Pad Length and Padding fields if present. If an IP frame is received whose stream is not in “open” or “half-closed (local)” state, the recipient MUST respond with a stream error (<a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a> Section 5.4.2) of type STREAM_CLOSED.</p></div><div id="rfc.section.2.2.p.9"><p>The total number of padding octets is determined by the value of the Pad Length field. If the length of the padding is the length of the frame payload or greater, the recipient MUST treat this as a connection error (<a href="#RFC7540"><cite title="Hypertext Transfer Protocol Version 2 (HTTP/2)">[RFC7540]</cite></a> Section 5.4.1) of type PROTOCOL_ERROR.</p></div><div id="rfc.section.2.2.p.10"><p>Note: An IP frame can be increased in size by one octet by including a Pad Length field with a value of zero.</p></div></div></div><div id="vpn-over-http2-operation"><h2 id="rfc.section.3"><a href="#rfc.section.3">3.</a>&nbsp;<a href="#vpn-over-http2-operation">VPN over HTTP/2 Operation</a></h2><div id="rfc.section.3.p.1"><p>After a HTTP/2 connection is started (e.g., using the “h2” protocol identifier), either peer MAY initiate a VPN by sending a STARTVPN frame.</p></div><div id="rfc.section.3.p.2"><p>The initiating STARTVPN SHOULD contain authentication data to allow the recipient to determine whether its peer is authorized to create a VPN; however, alternative mechanisms MAY be used (e.g., TLS client certificates).</p></div><div id="rfc.section.3.p.3"><p>If the other peer is willing and able to create a VPN, it will reply with a STARTVPN frame on the same stream. Otherwise, as per HTTP/2, it MUST ignore the frame. IP frames MUST not be sent by either peer before a STARTVPN frame is received.</p></div><div id="rfc.section.3.p.4"><p>Note that HTTP/2 connections MAY carry multiple VPN connections simultaneously, and MAY also carry normal HTTP traffic.</p></div><div id="rfc.section.3.p.5"><p>Upon successful establishment of a VPN, the peers can begin exchanging IP frames. Address discovery can occur as would over a normal IP connection (e.g., using static configuration or DHCP).</p></div></div><div id="iana-considerations"><h2 id="rfc.section.4"><a href="#rfc.section.4">4.</a>&nbsp;<a href="#iana-considerations">IANA Considerations</a></h2><div id="rfc.section.4.p.1"><p>This document does not require action by IANA.</p></div></div><div id="security-considerations"><h2 id="rfc.section.5"><a href="#rfc.section.5">5.</a>&nbsp;<a href="#security-considerations">Security Considerations</a></h2><div id="rfc.section.5.p.1"><p>This specification is designed to avoid the exposure of discriminators to observers, to make it more difficult to block a VPN. However, VPN traffic has different characteristics (e.g., traffic volumes and timing, especially when it’s possible to compare “normal” HTTP/2 traffic to it. Padding (both in the IP frames and the HTTP/2 HEADERS and DATA frames) may partially mitigate these attacks.</p></div></div><h2 id="rfc.references.1"><a href="#rfc.section.6" id="rfc.section.6">6.</a> Normative References</h2><table><tr><td class="reference"><b id="RFC0791">[RFC0791]</b></td><td class="top">Postel, J., “<a href="http://www.rfc-editor.org/info/rfc791">Internet Protocol</a>”, STD&nbsp;5, RFC&nbsp;791, <a href="http://dx.doi.org/10.17487/RFC0791">DOI&nbsp;10.17487/RFC0791</a>, September&nbsp;1981, &lt;<a href="http://www.rfc-editor.org/info/rfc791">http://www.rfc-editor.org/info/rfc791</a>&gt;.</td></tr><tr><td class="reference"><b id="RFC2119">[RFC2119]</b></td><td class="top">Bradner, S., “<a href="http://www.rfc-editor.org/info/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>”, BCP&nbsp;14, RFC&nbsp;2119, <a href="http://dx.doi.org/10.17487/RFC2119">DOI&nbsp;10.17487/RFC2119</a>, March&nbsp;1997, &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.</td></tr><tr><td class="reference"><b id="RFC2460">[RFC2460]</b></td><td class="top">Deering, S. and R. Hinden, “<a href="http://www.rfc-editor.org/info/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>”, RFC&nbsp;2460, <a href="http://dx.doi.org/10.17487/RFC2460">DOI&nbsp;10.17487/RFC2460</a>, December&nbsp;1998, &lt;<a href="http://www.rfc-editor.org/info/rfc2460">http://www.rfc-editor.org/info/rfc2460</a>&gt;.</td></tr><tr><td class="reference"><b id="RFC7540">[RFC7540]</b></td><td class="top">Belshe, M., Peon, R., and M. Thomson, Ed., “<a href="http://www.rfc-editor.org/info/rfc7540">Hypertext Transfer Protocol Version 2 (HTTP/2)</a>”, RFC&nbsp;7540, <a href="http://dx.doi.org/10.17487/RFC7540">DOI&nbsp;10.17487/RFC7540</a>, May&nbsp;2015, &lt;<a href="http://www.rfc-editor.org/info/rfc7540">http://www.rfc-editor.org/info/rfc7540</a>&gt;.</td></tr></table><div id="todo"><h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">A.</a>&nbsp;<a href="#todo">TODO</a></h2><div id="rfc.section.A.p.1"><ul><li>Authentication needs to be solidified.</li><li>DHCP may not be realistic for IP address + DNS.</li><li>Allow the server to specify routable addresses.</li></ul></div></div><div class="avoidbreakinside"><h2 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h2><p><b>Mark Nottingham</b><br>EMail: <a href="mailto:mnot@mnot.net">mnot@mnot.net</a><br>URI: <a href="http://www.mnot.net/">http://www.mnot.net/</a></p></div></div></div></div><script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script></body></html>