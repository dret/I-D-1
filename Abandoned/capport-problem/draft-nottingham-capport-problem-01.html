<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN" "about:legacy-compat">
<html lang="en"><head profile="http://dublincore.org/documents/2008/08/04/dc-html/"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><title>Captive Portals Problem Statement</title><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css"><style type="text/css">
      body {
        padding-top: 80px;
        padding-bottom: 80px;
        position: relative;
      }
      .table.header th, .table.header td {
        border-top: none;
        padding: 0;
      }
      #rfc\.meta {
        width: 40%;
        float: right
      }
      #rfc\.toc > ul li {
        list-style: none;
      }
      .container .nav-sublist {
        padding-left: 20px;
        padding-right: 10px;
        font-size: 90%;
      }
      .container .navbar-brand {
        padding-top: 0;
      }
      .container .nav > li > a {
        padding: 10px 7px 5px 15px;
        display: inline-block;
      }
      .container .nav > li > a + a {
        padding: 10px 15px 5px 7px;
        display: inline-block;
      }
      .container .nav > li > a {
        padding: 5px 10px;
      }
      .filename {
        color: rgb(119, 119, 119);
        font-size: 23px;
        font-weight: normal;
        height: auto;
        line-height: 23px;
      }
      dl {
        margin-left: 1em;
      }
      dl.dl-horizontal: {
        margin-left: 0;
      }
      dl > dt {
        float: left;
        margin-right: 1em;
      }
      dl.nohang > dt {
        float: none;
      }
      dl > dd {
        margin-bottom: .5em;
      }
      dl.compact > dd {
        margin-bottom: 0em;
      }
      dl > dd > dl {
        margin-top: 0.5em;
        margin-bottom: 0em;
      }
      ul.empty {
        list-style-type: none;
      }
      ul.empty li {
        margin-top: .5em;
      }
      td.reference {
        padding-right: 1em;
        vertical-align: top;
      }
      .feedback {
        position: fixed;
        bottom: 5px;
        right: 5px;
      }
      .fbbutton {
        margin-left: 5px;
      }
      h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
        color: rgb(51, 51, 51);
      }
    </style><link rel="Author" href="#rfc.authors"><link rel="Copyright" href="#rfc.copyrightnotice"><link rel="Chapter" title="1 Introduction" href="#rfc.section.1"><link rel="Chapter" title="2 Defining Captive Portals and Networks" href="#rfc.section.2"><link rel="Chapter" title="3 Issues Caused by Captive Portals" href="#rfc.section.3"><link rel="Chapter" title="4 Issues Caused by Captive Portal Detection" href="#rfc.section.4"><link rel="Chapter" title="5 Security Considerations" href="#rfc.section.5"><link rel="Chapter" href="#rfc.section.6" title="6 Normative References"><link rel="Appendix" title="A Acknowledgements" href="#rfc.section.A"><meta name="generator" content="https://github.com/mnot/RFCBootstrap XSLT vendor: Saxonica http://www.saxonica.com/"><meta name="keywords" content="Internet-Draft"><link rel="schema.dct" href="http://purl.org/dc/terms/"><meta name="dct.creator" content="Nottingham, M."><meta name="dct.identifier" content="urn:ietf:id:draft-nottingham-capport-problem-01"><meta name="dct.issued" scheme="ISO8601" content="2016-04-04"><meta name="dct.abstract" content="This draft attempts to establish a problem statement for “Captive Portals”, in order to inform discussions of improving their operation."><meta name="description" content="This draft attempts to establish a problem statement for “Captive Portals”, in order to inform discussions of improving their operation."></head><body><div class="container" id="top"><div class="row"><div class="col-md-4 col-md-push-8 hidden-sm hidden-xs" role="navigation"><div class="navbar"><div class="navbar-brand"><a href="#top">Internet-Draft</a></div><br clear="all"><div class=""><div id="rfc.toc"><ul class="nav"><li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#introduction">Introduction</a><ul><li><a href="#rfc.section.1.1">1.1</a>&nbsp;&nbsp;&nbsp;<a href="#notational-conventions">Notational Conventions</a></li></ul></li><li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#defining-captive-portals-and-networks">Defining Captive Portals and Networks</a><ul><li><a href="#rfc.section.2.1">2.1</a>&nbsp;&nbsp;&nbsp;<a href="#why">Why Captive Portals Are Used</a></li></ul></li><li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#issues">Issues Caused by Captive Portals</a></li><li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#issues-detection">Issues Caused by Captive Portal Detection</a><ul><li><a href="#rfc.section.4.1">4.1</a>&nbsp;&nbsp;&nbsp;<a href="#issues-caused-by-defeating-captive-portal-detection">Issues Caused by Defeating Captive Portal Detection</a></li></ul></li><li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#security-considerations">Security Considerations</a></li><li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">Normative References</a></li><li><a href="#rfc.section.A">A.</a>&nbsp;&nbsp;&nbsp;<a href="#acknowledgements">Acknowledgements</a></li><li><a href="#rfc.authors">Author's Address</a></li></ul></div></div></div></div><div class="col-md-8 col-md-pull-4 main" role="main"><table class="table table-condensed header" id="rfc.headerblock"><tbody><tr><td class="text-left">Network Working Group</td><td class="text-right">M. Nottingham</td></tr><tr><td class="text-left">Internet-Draft</td><td class="text-right">April 4, 2016</td></tr><tr><td class="text-left">Intended status: Informational</td><td class="text-right"></td></tr><tr><td class="text-left">Expires: October 6, 2016</td><td class="text-right"></td></tr></tbody></table><div id="rfc.title"><h1>Captive Portals Problem Statement</h1><div class="filename">draft-nottingham-capport-problem-01</div></div><hr><h2 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h2><div class="lead"><p>This draft attempts to establish a problem statement for “Captive Portals”, in order to inform discussions of improving their operation.</p></div><h2 id="rfc.note.1"><a href="#rfc.note.1">Note to Readers</a></h2><p>The issues list for this draft can be found at <a href="https://github.com/mnot/I-D/labels/capport-problem">https://github.com/mnot/I-D/labels/capport-problem</a>.</p><p>The most recent (often, unpublished) draft is at <a href="https://mnot.github.io/I-D/capport-problem/">https://mnot.github.io/I-D/capport-problem/</a>.</p><p>Recent changes are listed at <a href="https://github.com/mnot/I-D/commits/gh-pages/capport-problem">https://github.com/mnot/I-D/commits/gh-pages/capport-problem</a>.</p><div id="rfc.status"><h2><a href="#rfc.status">Status of this Memo</a></h2><p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p><p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF). Note that other groups may also distribute working documents as Internet-Drafts. The list of current Internet-Drafts is at <a href="http://datatracker.ietf.org/drafts/current/">http://datatracker.ietf.org/drafts/current/</a>.</p><p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time. It is inappropriate to use Internet-Drafts as reference material or to cite them other than as “work in progress”.</p><p>This Internet-Draft will expire on October 6, 2016.</p></div><div id="rfc.copyrightnotice"><h2><a href="#rfc.copyrightnotice">Copyright Notice</a></h2><p>Copyright © 2016 IETF Trust and the persons identified as the document authors. All rights reserved.</p><p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (<a href="http://trustee.ietf.org/license-info">http://trustee.ietf.org/license-info</a>) in effect on the date of publication of this document. Please review these documents carefully, as they describe your rights and restrictions with respect to this document. Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p></div><div id="introduction"><h2 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;<a href="#introduction">Introduction</a></h2><div id="rfc.section.1.p.1"><p>This draft attempts to establish a problem statement for “Captive Portals”, in order to inform discussions of improving their operation.</p></div><div id="notational-conventions"><h3 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1</a>&nbsp;<a href="#notational-conventions">Notational Conventions</a></h3><div id="rfc.section.1.1.p.1"><p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in <a href="#RFC2119"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>.</p></div></div></div><div id="defining-captive-portals-and-networks"><h2 id="rfc.section.2"><a href="#rfc.section.2">2.</a>&nbsp;<a href="#defining-captive-portals-and-networks">Defining Captive Portals and Networks</a></h2><div id="rfc.section.2.p.1"><p>A “<em>captive network</em>” is a network that employs a captive portal for a variety of purposes; see <a href="#why" title="Why Captive Portals Are Used">Section&nbsp;2.1</a>. A “<em>captive portal</em>” is a Web site that captive networks direct users to.</p></div><div id="rfc.section.2.p.2"><p>This is achieved by directing requests for “normal” Web access to the captive portal, through variety of techniques, including DNS poisoning, TCP interception, HTTP response modification and/or HTTP redirection.</p></div><div id="rfc.section.2.p.3"><p>Once the captive network’s goals are met, the network “remembers” that the user is allowed network access, usually by MAC address, although there is a significant amount of variance between implementations.</p></div><div id="rfc.section.2.p.4"><p>Over time, operating systems have developed “<em>captive portal detection</em>” processes to discover captive networks, and to assist users through the process of obtaining full network access. They often involve specialised “<em>captive portal browsers</em>” which only allow the captive portal to use a subset of the full capabilities of a Web browser, and have a different user experience.</p></div><div id="why"><h3 id="rfc.section.2.1"><a href="#rfc.section.2.1">2.1</a>&nbsp;<a href="#why">Why Captive Portals Are Used</a></h3><div id="rfc.section.2.1.p.1" class="avoidbreakafter"><p>Captive portals are deployed in a variety of situations, but the most common motivations are:</p></div><div id="rfc.section.2.1.p.2"><ul><li><strong>Authentication</strong> - Obtaining user credentials before authorising network access</li><li><strong>Payment</strong> - Obtaining payment for using the network.</li><li><strong>Information</strong> - Presenting information to the user. This might include displaying legal notices, details about the network provider and/or its location, advertisements, policies, etc., and obtaining user consent.</li><li><strong>Notifications</strong> - Some networks use the same mechanisms as captive portals to notify users of account status, network downtime, emergency alerts, etc. See <a href="#RFC6108"><cite title="Comcast's Web Notification System Design">[RFC6108]</cite></a> for an example of one way this is done.</li></ul></div><div id="rfc.section.2.1.p.3"><p>In all of these cases, using a Web browser is attractive, because it gives the network the ability to tailor the user’s interface and experience, as well as the ability to integrate third-party payment, advertising, authentication and other services.</p></div></div></div><div id="issues"><h2 id="rfc.section.3"><a href="#rfc.section.3">3.</a>&nbsp;<a href="#issues">Issues Caused by Captive Portals</a></h2><div id="rfc.section.3.p.1"><p>When a network imposes a captive portal, it can cause a variety of issues, both for applications and end users.</p></div><div id="rfc.section.3.p.2"><ul><li><strong>False Negatives</strong> - Because so many different heuristics are used to detect a captive portal, it’s common for an OS or browser to think it’s on an open network, <a href="https://discussions.apple.com/thread/6251349">when in fact there is a captive portal</a> in place.</li><li><strong>Longevity</strong> - Often, it’s necessary to <a href="https://community.aerohive.com/aerohive/topics/ios_7_captive_portal_issues">repeatedly log into a captive portal</a>, thanks to timeout issues. The effects of this range from annoyance to inability to complete tasks, depending on the timeout and the task at hand.</li><li><strong>Interoperability Issues</strong> - Captive portals often depend on specific operating system and browser capabilities and behaviours. Client systems that do not share those quirks often have difficulty connecting to captive portals.</li><li><strong>Confusion</strong> - Because captive portals are effectively a man-in-the-middle attack, they can confuse users as well as user agents (e.g., caches). For example, when the portal’s TLS certificate doesn’t match that of the requested site, or the captive portal’s /favicon.ico gets used as that of the originally requested site.</li><li><strong>DNS</strong>/<strong>DNSSEC</strong> - When portals respond with forged DNS answers, they confuse DNS resolvers and interoperate poorly with host-validating DNSSEC resolvers and applications.</li><li><strong>TLS</strong> - Portals that attempt to intercept TLS sessions (HTTPS, IMAPS, or other) can cause certificate error messages on clients, encouraging bad practice to click through such errors.</li><li><strong>Unexpected Configuration</strong> - Some captive portals do not work with clients using unexpected configurations, for example clients using static IP, custom DNS servers, or HTTP proxies.</li><li><strong>Stealing Access</strong> - because captive portals often associate a user with a MAC address, it is possible for an attacker to impersonate an authenticated client (e.g., one that has paid for Internet access). Note that this is specific to open Wifi, and can be prevented by using a secure wireless medium. However, configuration of secure wireless is often deemed to be too complex for captive networks.</li><li><strong>Non-Browser Clients</strong> - It is becoming more common for Internet devices without the ability to run a browser to be used, thanks to the “Internet of Things.” These devices cannot easily use most networks that interpose a captive portal.</li><li><strong>Connectivity Interruption</strong> - For a device with multiple network interfaces (e.g., cellular and WiFi), connecting to a network can require dropping access to alternative network interfaces. If such a device connects to a network with a captive portal, it can lose network connectivity until the captive portal requirements are satisfied.</li></ul></div></div><div id="issues-detection"><h2 id="rfc.section.4"><a href="#rfc.section.4">4.</a>&nbsp;<a href="#issues-detection">Issues Caused by Captive Portal Detection</a></h2><div id="rfc.section.4.p.1" class="avoidbreakafter"><p>Many operating systems attempt to detect when they are on a captive network. Detection aims to minimize the negative effects caused by interposition of captive portals, but can cause different issues, including:</p></div><div id="rfc.section.4.p.2"><ul><li><strong>False Positives</strong> - Some networks don’t use a Web browser interface to log in; e.g., they <a href="http://stackoverflow.com/questions/14606131/using-captive-network-assistant-on-macosx-to-connect-to-vpn">require a VPN to access the network</a>, so captive portal detection relying on HTTP is counterproductive.</li><li><strong>Non-Internet Networks</strong> - <a href="http://forum.piratebox.cc/read.php?9,8879">Some applications</a> and/or networks don’t assume Internet access, but captive portal detection often conflates “network access” with “Internet access”.</li><li><strong>Sandboxing</strong> - When a captive portal is detected, some operating systems access the captive portal in a highly sandboxed captive portal browser. This might have reduced capabilities, such as limited access to browser APIs. In addition, this environment is separate from a user’s normal browsing environment and therefore does not include state. While sandboxing seems a good idea to protect user data (particularly on Open WiFi), it is implemented differently on various platforms and often causes a (severely) broken user experience on the captive portal (even when the operator is protecting user data end-to-end with HTTPS). To offer a consistent and rich experience on the captive portal, some operators actively try to defeat operating system captive portal detection.</li></ul></div><div id="issues-caused-by-defeating-captive-portal-detection"><h3 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1</a>&nbsp;<a href="#issues-caused-by-defeating-captive-portal-detection">Issues Caused by Defeating Captive Portal Detection</a></h3><div id="rfc.section.4.1.p.1"><p>Many captive portal devices provide optional mechanisms that aim to defeat captive portal detection.</p></div><div id="rfc.section.4.1.p.2"><p>Such defeat mechanisms aim to avoid the problems caused by captive portal detection (see <a href="#issues-detection" title="Issues Caused by Captive Portal Detection">Section&nbsp;4</a>), with the consequence that they also cause the same problems that detection was intended to avoid (see <a href="#issues" title="Issues Caused by Captive Portals">Section&nbsp;3</a>).</p></div></div></div><div id="security-considerations"><h2 id="rfc.section.5"><a href="#rfc.section.5">5.</a>&nbsp;<a href="#security-considerations">Security Considerations</a></h2><div id="rfc.section.5.p.1"><p>TBD</p></div></div><h2 id="rfc.references"><a href="#rfc.section.6" id="rfc.section.6">6.</a> Normative References</h2><dl class="dl-horizontal"><dt id="RFC2119">[RFC2119]</dt><dd>Bradner, S., “<a href="http://www.rfc-editor.org/info/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>”, BCP&nbsp;14, RFC&nbsp;2119, <a href="http://dx.doi.org/10.17487/RFC2119">DOI&nbsp;10.17487/RFC2119</a>, March&nbsp;1997, &lt;<a href="http://www.rfc-editor.org/info/rfc2119">http://www.rfc-editor.org/info/rfc2119</a>&gt;.</dd><dt id="RFC6108">[RFC6108]</dt><dd>Chung, C., Kasyanov, A., Livingood, J., Mody, N., and B. Van Lieu, “<a href="http://www.rfc-editor.org/info/rfc6108">Comcast's Web Notification System Design</a>”, RFC&nbsp;6108, <a href="http://dx.doi.org/10.17487/RFC6108">DOI&nbsp;10.17487/RFC6108</a>, February&nbsp;2011, &lt;<a href="http://www.rfc-editor.org/info/rfc6108">http://www.rfc-editor.org/info/rfc6108</a>&gt;.</dd></dl><div id="acknowledgements"><h2 id="rfc.section.A" class="np"><a href="#rfc.section.A">A.</a>&nbsp;<a href="#acknowledgements">Acknowledgements</a></h2><div id="rfc.section.A.p.1"><p>This draft was seeded from the <a href="https://github.com/httpwg/wiki/wiki/Captive-Portals">HTTP Working Group Wiki Page on Captive Portals</a>; thanks to all who contributed there.</p></div><div id="rfc.section.A.p.2"><p>Thanks to Martin Thomson, Yaron Sheffer, David Bird and Jason Livingood for their suggestions.</p></div></div><div class="avoidbreakinside"><h2 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h2><p><b>Mark Nottingham</b><br>EMail: <a href="mailto:mnot@mnot.net">mnot@mnot.net</a><br>URI: <a href="https://www.mnot.net/">https://www.mnot.net/</a></p></div></div></div></div><script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script></body></html>