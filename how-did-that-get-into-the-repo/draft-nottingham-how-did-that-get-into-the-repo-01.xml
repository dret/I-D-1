<?xml version="1.0" encoding="UTF-8"?>
  <?xml-stylesheet type="text/xsl" href="rfc2629.xslt" ?>
  <!-- generated by https://github.com/cabo/kramdown-rfc2629 version 1.2.10 -->

<!DOCTYPE rfc SYSTEM "../Tools/rfcbootstrap/rfc2629.dtd" [
]>

<?rfc toc="yes"?>
<?rfc tocindent="yes"?>
<?rfc sortrefs="yes"?>
<?rfc symrefs="yes"?>
<?rfc strict="yes"?>
<?rfc compact="yes"?>
<?rfc comments="yes"?>
<?rfc inline="yes"?>

<rfc ipr="trust200902" docName="draft-nottingham-how-did-that-get-into-the-repo-01" category="info">

  <front>
    <title>The secret-token URI Scheme</title>

    <author initials="M." surname="Nottingham" fullname="Mark Nottingham">
      <organization></organization>
      <address>
        <email>mnot@mnot.net</email>
        <uri>https://www.mnot.net/</uri>
      </address>
    </author>

    <date year="2019"/>

    <area>General</area>
    
    <keyword>Internet-Draft</keyword>

    <abstract>


<t>This document registers the “secret-token” URI scheme, to aid in the identification
of authentication tokens.</t>



    </abstract>


    <note title="Note to Readers">


<t><spanx style="emph">RFC EDITOR: please remove this section before publication</spanx></t>

<t>The issues list for this draft can be found at <eref target="https://github.com/mnot/I-D/labels/how-did-that-get-into-the-repo">https://github.com/mnot/I-D/labels/how-did-that-get-into-the-repo</eref>.</t>

<t>The most recent (often, unpublished) draft is at <eref target="https://mnot.github.io/I-D/how-did-that-get-into-the-repo/">https://mnot.github.io/I-D/how-did-that-get-into-the-repo/</eref>.</t>

<t>Recent changes are listed at <eref target="https://github.com/mnot/I-D/commits/gh-pages/how-did-that-get-into-the-repo">https://github.com/mnot/I-D/commits/gh-pages/how-did-that-get-into-the-repo</eref>.</t>

<t>See also the draft’s current status in the IETF datatracker, at
<eref target="https://datatracker.ietf.org/doc/draft-nottingham-how-did-that-get-into-the-repo/">https://datatracker.ietf.org/doc/draft-nottingham-how-did-that-get-into-the-repo/</eref>.</t>


    </note>


  </front>

  <middle>


<section anchor="introduction" title="Introduction">

<t>It has become increasingly common to use bearer tokens as an authentication mechanism.</t>

<t>Unfortunately, the number of security incidents involving accidental disclosure of these tokens has also increased. For example, we now regularly hear about a developer committing an access token to a public source code repository, either because they didn’t realise it was included in the committed code, or because they didn’t realise the implications of its disclosure.</t>

<t>This specification registers the “secret-token” URI scheme to aid prevention of such accidental disclosures. When tokens are easier to unambiguously identify, they can trigger warnings in Continuous Integration systems, or be used in source code repositories themselves. They can also be scanned for separately.</t>

<t>For example, if cloud.example.net issues access tokens to its clients for later use, and it does so by formatting them as secret-token URIs, tokens that “leak” into places that they don’t belong are easier to identify. This could be through a variety of mechanisms; for example, if repo.example.com can be configured to refuse commits containing secret-token URIs, it helps its customers avoid accidental disclosures.</t>

<t>secret-token URIs are intended to aid in identification of generated secrets like API keys and similar tokens. They are not intended for use in controlled situations where ephemeral tokens are used, such as things ike CSRF tokens.</t>

<section anchor="notational-conventions" title="Notational Conventions">

<t>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”,
“RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as
described in BCP 14 <xref target="RFC2119"/> <xref target="RFC8174"/> when, and only when, they appear in all capitals, as
shown here.</t>

<t>This document uses ABNF <xref target="RFC5234"/>, including by reference the following rules: ALPHA, DIGIT. It also uses the pchar rule from <xref target="RFC3986"/>.</t>

</section>
</section>
<section anchor="the-secret-token-uri-scheme" title="The secret-token URI scheme">

<t>The secret-token URI scheme identifies a token that is intended to be a secret.</t>

<figure><artwork type="abnf"><![CDATA[
secret-token-URI    = secret-token-scheme ":" token
secret-token-scheme = "secret-token"
token               = 1*pchar
]]></artwork></figure>

<t>See <xref target="RFC3986"/>, Section 3.3 for a definition of pchar. Disallowed characters – including non-ASCII characters – MUST be encoded into UTF-8 <xref target="RFC3629"/> and then percent-encoded (<xref target="RFC3986"/>, Section 2.1).</t>

<t>When a token is both generated and presented for authentication, the entire URI MUST be used,
without changes.</t>

<t>For example, given the URI:</t>

<figure><artwork type="example"><![CDATA[
secret-token:E92FB7EB-D882-47A4-A265-A0B6135DC842%20foo
]]></artwork></figure>

<t>This string (character-for-character, case-sensitive) will both be issued by the token authority, and required for later access.</t>

</section>
<section anchor="iana-considerations" title="IANA Considerations">

<t>This document registers the following value in the URI Scheme registry:</t>

<t><list style="symbols">
  <t>Scheme name: secret-token</t>
  <t>Status: provisional</t>
  <t>Applications / protocols that use this scheme: none yet</t>
  <t>Contact: iesg@iesg.org</t>
  <t>Change Controller: IESG</t>
  <t>References: [this document]</t>
</list></t>

</section>
<section anchor="security-considerations" title="Security Considerations">

<t>The token ABNF rule allows tokens as small as one character. This is not recommended practice; applications should evaluate their requirements for entropy and issue tokens correspondingly.</t>

<t>This URI scheme is intended to prevent accidental disclosure; it cannot prevent intentional disclosure.</t>

<t>If it is difficult to correctly handle secret material, or unclear as to what the appropriate handling is, users might choose to obfuscate their secret tokens in order to evade detection (for example, removing the URI scheme for storage). Clear guidelines and helpful tools are good mitigations here.</t>

</section>


  </middle>

  <back>

    <references title='Normative References'>





<reference  anchor="RFC2119" target='https://www.rfc-editor.org/info/rfc2119'>
<front>
<title>Key words for use in RFCs to Indicate Requirement Levels</title>
<author initials='S.' surname='Bradner' fullname='S. Bradner'><organization /></author>
<date year='1997' month='March' />
<abstract><t>In many standards track documents several words are used to signify the requirements in the specification.  These words are often capitalized. This document defines these words as they should be interpreted in IETF documents.  This document specifies an Internet Best Current Practices for the Internet Community, and requests discussion and suggestions for improvements.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='2119'/>
<seriesInfo name='DOI' value='10.17487/RFC2119'/>
</reference>



<reference  anchor="RFC8174" target='https://www.rfc-editor.org/info/rfc8174'>
<front>
<title>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</title>
<author initials='B.' surname='Leiba' fullname='B. Leiba'><organization /></author>
<date year='2017' month='May' />
<abstract><t>RFC 2119 specifies common key words that may be used in protocol  specifications.  This document aims to reduce the ambiguity by clarifying that only UPPERCASE usage of the key words have the  defined special meanings.</t></abstract>
</front>
<seriesInfo name='BCP' value='14'/>
<seriesInfo name='RFC' value='8174'/>
<seriesInfo name='DOI' value='10.17487/RFC8174'/>
</reference>



<reference  anchor="RFC5234" target='https://www.rfc-editor.org/info/rfc5234'>
<front>
<title>Augmented BNF for Syntax Specifications: ABNF</title>
<author initials='D.' surname='Crocker' fullname='D. Crocker' role='editor'><organization /></author>
<author initials='P.' surname='Overell' fullname='P. Overell'><organization /></author>
<date year='2008' month='January' />
<abstract><t>Internet technical specifications often need to define a formal syntax.  Over the years, a modified version of Backus-Naur Form (BNF), called Augmented BNF (ABNF), has been popular among many Internet specifications.  The current specification documents ABNF. It balances compactness and simplicity with reasonable representational power.  The differences between standard BNF and ABNF involve naming rules, repetition, alternatives, order-independence, and value ranges.  This specification also supplies additional rule definitions and encoding for a core lexical analyzer of the type common to several Internet specifications.  [STANDARDS-TRACK]</t></abstract>
</front>
<seriesInfo name='STD' value='68'/>
<seriesInfo name='RFC' value='5234'/>
<seriesInfo name='DOI' value='10.17487/RFC5234'/>
</reference>



<reference  anchor="RFC3986" target='https://www.rfc-editor.org/info/rfc3986'>
<front>
<title>Uniform Resource Identifier (URI): Generic Syntax</title>
<author initials='T.' surname='Berners-Lee' fullname='T. Berners-Lee'><organization /></author>
<author initials='R.' surname='Fielding' fullname='R. Fielding'><organization /></author>
<author initials='L.' surname='Masinter' fullname='L. Masinter'><organization /></author>
<date year='2005' month='January' />
<abstract><t>A Uniform Resource Identifier (URI) is a compact sequence of characters that identifies an abstract or physical resource.  This specification defines the generic URI syntax and a process for resolving URI references that might be in relative form, along with guidelines and security considerations for the use of URIs on the Internet.  The URI syntax defines a grammar that is a superset of all valid URIs, allowing an implementation to parse the common components of a URI reference without knowing the scheme-specific requirements of every possible identifier.  This specification does not define a generative grammar for URIs; that task is performed by the individual specifications of each URI scheme.  [STANDARDS-TRACK]</t></abstract>
</front>
<seriesInfo name='STD' value='66'/>
<seriesInfo name='RFC' value='3986'/>
<seriesInfo name='DOI' value='10.17487/RFC3986'/>
</reference>



<reference  anchor="RFC3629" target='https://www.rfc-editor.org/info/rfc3629'>
<front>
<title>UTF-8, a transformation format of ISO 10646</title>
<author initials='F.' surname='Yergeau' fullname='F. Yergeau'><organization /></author>
<date year='2003' month='November' />
<abstract><t>ISO/IEC 10646-1 defines a large character set called the Universal Character Set (UCS) which encompasses most of the world's writing systems.  The originally proposed encodings of the UCS, however, were not compatible with many current applications and protocols, and this has led to the development of UTF-8, the object of this memo.  UTF-8 has the characteristic of preserving the full US-ASCII range, providing compatibility with file systems, parsers and other software that rely on US-ASCII values but are transparent to other values.  This memo obsoletes and replaces RFC 2279.</t></abstract>
</front>
<seriesInfo name='STD' value='63'/>
<seriesInfo name='RFC' value='3629'/>
<seriesInfo name='DOI' value='10.17487/RFC3629'/>
</reference>




    </references>




  </back>

<!-- ##markdown-source:
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

-->

</rfc>

